-- Services
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

-- Player
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
local humanoid = character:WaitForChild("Humanoid")

-- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π
local speedEnabled = false
local speedConnection = nil
local targetSpeed = 100

local flyEnabled = false
local flyConnection = nil
local targetYPosition = 0
local flyHeight = 100
local originalGravity = workspace.Gravity

-- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –±–∞–∑—ã
local basePosition = nil
local baseMarker = nil

-- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é
local menuVisible = true
local isDraggingMenuButton = false
local dragStartPosition = nil
local menuButtonStartPosition = nil

-- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏ –º–µ–Ω—é
local lastMenuPosition = UDim2.new(0, 80, 0, 50)

-- –°–æ–∑–¥–∞–Ω–∏–µ GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "DragMenu"
ScreenGui.Parent = player.PlayerGui
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling -- –ü–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å z-index –≤—Ä—É—á–Ω—É—é

-- –ö—Ä—É–≥–ª–∞—è –∫–Ω–æ–ø–∫–∞ –º–µ–Ω—é (–í–´–°–û–ö–ò–ô Z-INDEX —á—Ç–æ–±—ã –±—ã–ª–∞ –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ)
local MenuButton = Instance.new("TextButton")
MenuButton.Name = "MenuButton"
MenuButton.Size = UDim2.new(0, 60, 0, 60)
MenuButton.Position = UDim2.new(0, 10, 0.5, -30)
MenuButton.AnchorPoint = Vector2.new(0, 0.5)
MenuButton.BackgroundColor3 = Color3.fromRGB(128, 0, 128) -- –§–∏–æ–ª–µ—Ç–æ–≤—ã–π —Ü–≤–µ—Ç
MenuButton.Text = "Menu"
MenuButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MenuButton.Font = Enum.Font.GothamBold
MenuButton.TextSize = 14
MenuButton.AutoButtonColor = false
MenuButton.ZIndex = 1000 -- –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∏–π z-index —á—Ç–æ–±—ã –±—ã—Ç—å –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ
MenuButton.Parent = ScreenGui

-- –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ (–¥–µ–ª–∞–µ–º –∫—Ä—É–≥–ª–æ–π)
local MenuButtonCorner = Instance.new("UICorner")
MenuButtonCorner.CornerRadius = UDim.new(1, 0) -- –ü–æ–ª–Ω–æ—Å—Ç—å—é –∫—Ä—É–≥–ª–∞—è
MenuButtonCorner.Parent = MenuButton

-- –¢–µ–Ω—å –∫–Ω–æ–ø–∫–∏
local MenuButtonStroke = Instance.new("UIStroke")
MenuButtonStroke.Color = Color3.fromRGB(80, 0, 80)
MenuButtonStroke.Thickness = 3
MenuButtonStroke.Parent = MenuButton

-- –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—Ä–µ–π–º –º–µ–Ω—é
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 220, 0, 250)
MainFrame.Position = lastMenuPosition -- –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –ø–æ–∑–∏—Ü–∏—é
MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true -- –í–∫–ª—é—á–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ
MainFrame.ZIndex = 999 -- –í—ã—Å–æ–∫–∏–π z-index, –Ω–æ –Ω–∏–∂–µ —á–µ–º —É –∫–Ω–æ–ø–∫–∏
MainFrame.Parent = ScreenGui

-- –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤
local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 8)
UICorner.Parent = MainFrame

-- –¢–µ–Ω—å
local UIStroke = Instance.new("UIStroke")
UIStroke.Color = Color3.fromRGB(20, 20, 30)
UIStroke.Thickness = 3
UIStroke.Parent = MainFrame

-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –º–µ–Ω—é
local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Size = UDim2.new(1, -20, 0, 35)
Title.Position = UDim2.new(0, 10, 0, 10)
Title.BackgroundTransparency = 1
Title.Text = "made by xabib"
Title.TextColor3 = Color3.fromRGB(255, 105, 180)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 18
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.ZIndex = 1000 -- –í—ã—Å–æ–∫–∏–π z-index –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞
Title.Parent = MainFrame

-- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
local Divider = Instance.new("Frame")
Divider.Name = "Divider"
Divider.Size = UDim2.new(1, -20, 0, 1)
Divider.Position = UDim2.new(0, 10, 0, 50)
Divider.BackgroundColor3 = Color3.fromRGB(80, 80, 100)
Divider.BorderSizePixel = 0
Divider.ZIndex = 1000
Divider.Parent = MainFrame

-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–Ω–æ–ø–æ–∫
local ButtonsContainer = Instance.new("Frame")
ButtonsContainer.Name = "ButtonsContainer"
ButtonsContainer.Size = UDim2.new(1, -20, 0, 180)
ButtonsContainer.Position = UDim2.new(0, 10, 0, 60)
ButtonsContainer.BackgroundTransparency = 1
ButtonsContainer.ZIndex = 1000
ButtonsContainer.Parent = MainFrame

-- –°—Ç–∏–ª—å –¥–ª—è –∫–Ω–æ–ø–æ–∫
local function createButton(name, text, positionY)
    local button = Instance.new("TextButton")
    button.Name = name
    button.Size = UDim2.new(1, 0, 0, 30)
    button.Position = UDim2.new(0, 0, 0, positionY)
    button.BackgroundColor3 = Color3.fromRGB(45, 45, 60)
    button.BorderSizePixel = 0
    button.Text = text
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.Font = Enum.Font.Gotham
    button.TextSize = 14
    button.AutoButtonColor = false
    button.ZIndex = 1001 -- –í—ã—Å–æ–∫–∏–π z-index –¥–ª—è –∫–Ω–æ–ø–æ–∫
    
    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 6)
    buttonCorner.Parent = button
    
    local buttonStroke = Instance.new("UIStroke")
    buttonStroke.Color = Color3.fromRGB(60, 60, 80)
    buttonStroke.Thickness = 2
    buttonStroke.Parent = button
    
    button.Parent = ButtonsContainer
    return button
end

-- –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏
local TpUpButton = createButton("TpUpButton", "‚¨ÜÔ∏è Fly Mode: OFF", 0)
local TpForwardButton = createButton("TpForwardButton", "‚û°Ô∏è TP Forward (+5 studs)", 40)
local SpeedButton = createButton("SpeedButton", "üöÄ Speed: OFF", 80)
local SetBaseButton = createButton("SetBaseButton", "üè† Set Base", 120)
local FlyToBaseButton = createButton("FlyToBaseButton", "‚úàÔ∏è Fly to Base", 160)

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é
local function setupMenuButtonDrag()
    MenuButton.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            isDraggingMenuButton = true
            dragStartPosition = Vector2.new(input.Position.X, input.Position.Y)
            menuButtonStartPosition = MenuButton.Position
            
            -- –ü–æ–¥–Ω–∏–º–∞–µ–º z-index –∫–Ω–æ–ø–∫–∏ –µ—â–µ –≤—ã—à–µ –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏
            MenuButton.ZIndex = 1001
        end
    end)
    
    MenuButton.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            isDraggingMenuButton = false
            -- –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—ã—á–Ω—ã–π z-index
            MenuButton.ZIndex = 1000
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if isDraggingMenuButton and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = Vector2.new(input.Position.X, input.Position.Y) - dragStartPosition
            MenuButton.Position = UDim2.new(
                menuButtonStartPosition.X.Scale,
                menuButtonStartPosition.X.Offset + delta.X,
                menuButtonStartPosition.Y.Scale,
                menuButtonStartPosition.Y.Offset + delta.Y
            )
        end
    end)
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é
local function toggleMenu()
    menuVisible = not menuVisible
    
    if menuVisible then
        -- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ–Ω—é –Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
        MainFrame.Visible = true
        MainFrame.Position = lastMenuPosition
        MenuButton.Text = "Menu"
        
        -- –ü–ª–∞–≤–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ
        MainFrame.BackgroundTransparency = 1
        TweenService:Create(MainFrame, TweenInfo.new(0.3), {
            BackgroundTransparency = 0
        }):Play()
    else
        -- –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â—É—é –ø–æ–∑–∏—Ü–∏—é –ø–µ—Ä–µ–¥ —Å–∫—Ä—ã—Ç–∏–µ–º
        lastMenuPosition = MainFrame.Position
        
        -- –ü–ª–∞–≤–Ω–æ–µ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ
        TweenService:Create(MainFrame, TweenInfo.new(0.3), {
            BackgroundTransparency = 1
        }):Play()
        task.wait(0.3)
        MainFrame.Visible = false
        MenuButton.Text = "Menu"
    end
end

-- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–µ –º–µ–Ω—é
MenuButton.MouseButton1Click:Connect(function()
    if not isDraggingMenuButton then
        toggleMenu()
        
        -- –ê–Ω–∏–º–∞—Ü–∏—è –Ω–∞–∂–∞—Ç–∏—è
        TweenService:Create(MenuButton, TweenInfo.new(0.1), {
            BackgroundColor3 = Color3.fromRGB(100, 0, 100)
        }):Play()
        task.wait(0.1)
        TweenService:Create(MenuButton, TweenInfo.new(0.2), {
            BackgroundColor3 = Color3.fromRGB(128, 0, 128)
        }):Play()
    end
end)

-- –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–∑–∏—Ü–∏—é –º–µ–Ω—é –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏
MainFrame.Changed:Connect(function(property)
    if property == "Position" and menuVisible then
        lastMenuPosition = MainFrame.Position
    end
end)

-- –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –º–µ–Ω—é
MenuButton.MouseEnter:Connect(function()
    TweenService:Create(MenuButton, TweenInfo.new(0.2), {
        BackgroundColor3 = Color3.fromRGB(150, 0, 150)
    }):Play()
end)

MenuButton.MouseLeave:Connect(function()
    TweenService:Create(MenuButton, TweenInfo.new(0.2), {
        BackgroundColor3 = Color3.fromRGB(128, 0, 128)
    }):Play()
end)

-- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é
setupMenuButtonDrag()

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ä–∫–µ—Ä–∞ –±–∞–∑—ã
local function createBaseMarker(position)
    -- –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –º–∞—Ä–∫–µ—Ä –µ—Å–ª–∏ –µ—Å—Ç—å
    if baseMarker then
        baseMarker:Destroy()
    end
    
    -- –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –º–∞—Ä–∫–µ—Ä
    baseMarker = Instance.new("Part")
    baseMarker.Name = "BaseMarker"
    baseMarker.Size = Vector3.new(2, 2, 2)
    baseMarker.Position = position
    baseMarker.Anchored = true
    baseMarker.CanCollide = false
    baseMarker.Transparency = 0.5
    baseMarker.Color = Color3.fromRGB(0, 255, 0)
    baseMarker.Material = Enum.Material.Neon
    
    -- –î–æ–±–∞–≤–ª—è–µ–º —Å–≤–µ—á–µ–Ω–∏–µ
    local pointLight = Instance.new("PointLight")
    pointLight.Brightness = 2
    pointLight.Range = 10
    pointLight.Color = Color3.fromRGB(0, 255, 0)
    pointLight.Parent = baseMarker
    
    -- –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
    local billboardGui = Instance.new("BillboardGui")
    billboardGui.Size = UDim2.new(0, 100, 0, 40)
    billboardGui.StudsOffset = Vector3.new(0, 3, 0)
    billboardGui.AlwaysOnTop = true
    billboardGui.Parent = baseMarker
    
    local textLabel = Instance.new("TextLabel")
    textLabel.Size = UDim2.new(1, 0, 1, 0)
    textLabel.BackgroundTransparency = 1
    textLabel.Text = "BASE"
    textLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    textLabel.Font = Enum.Font.GothamBold
    textLabel.TextSize = 14
    textLabel.Parent = billboardGui
    
    baseMarker.Parent = workspace
    
    return baseMarker
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è
local function smoothTeleport(position)
    if character and humanoidRootPart then
        humanoidRootPart.CFrame = CFrame.new(position)
    end
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞ –∏–∑ –ø–æ–ª—ë—Ç–∞
local function safeExitFly()
    if flyEnabled and humanoidRootPart then
        -- –ü–µ—Ä–µ–¥ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ–º —É–±–∏—Ä–∞–µ–º –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—é –Ω–∞ –∫–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è
        workspace.Gravity = 0
        
        -- –ñ–¥—ë–º –Ω–µ–º–Ω–æ–≥–æ —á—Ç–æ–±—ã —Å–±—Ä–æ—Å–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è
        task.wait(0.2)
        
        -- –ü–ª–∞–≤–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—é
        for i = 0, 100, 20 do
            workspace.Gravity = i
            task.wait(0.05)
        end
        workspace.Gravity = originalGravity
    end
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è/–≤—ã–∫–ª—é—á–µ–Ω–∏—è –ø–æ–ª—ë—Ç–∞
local function toggleFly()
    flyEnabled = not flyEnabled
    
    if flyEnabled then
        -- –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—é
        originalGravity = workspace.Gravity
        
        -- –£–±–∏—Ä–∞–µ–º –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—é –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –ø–æ–ª—ë—Ç–∞
        workspace.Gravity = 0
        
        -- –ó–∞–ø–æ–º–∏–Ω–∞–µ–º —Ç–µ–∫—É—á–Ω—É—é –≤—ã—Å–æ—Ç—É –∏ –¥–æ–±–∞–≤–ª—è–µ–º 100 studs
        if humanoidRootPart then
            targetYPosition = humanoidRootPart.Position.Y + flyHeight
            TpUpButton.Text = "‚¨ÜÔ∏è Fly Mode: ON (" .. math.floor(targetYPosition) .. ")"
            
            -- –ü–ª–∞–≤–Ω–æ –ø–æ–¥–Ω–∏–º–∞–µ–º –Ω–∞ –Ω—É–∂–Ω—É—é –≤—ã—Å–æ—Ç—É
            local currentPosition = humanoidRootPart.Position
            local newPosition = Vector3.new(currentPosition.X, targetYPosition, currentPosition.Z)
            
            -- –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –ø–æ–¥—ä—ë–º–∞
            local startTime = tick()
            local startY = currentPosition.Y
            
            local liftConnection
            liftConnection = RunService.Heartbeat:Connect(function()
                if not flyEnabled or not humanoidRootPart then
                    liftConnection:Disconnect()
                    return
                end
                
                local progress = (tick() - startTime) / 1.0 -- 1 —Å–µ–∫—É–Ω–¥–∞ –Ω–∞ –ø–æ–¥—ä—ë–º
                if progress >= 1 then
                    humanoidRootPart.CFrame = CFrame.new(newPosition)
                    liftConnection:Disconnect()
                else
                    local currentY = startY + (targetYPosition - startY) * progress
                    local smoothPosition = Vector3.new(
                        currentPosition.X,
                        currentY,
                        currentPosition.Z
                    )
                    humanoidRootPart.CFrame = CFrame.new(smoothPosition)
                end
            end)
        end
        
        -- –°–æ–∑–¥–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –≤—ã—Å–æ—Ç—ã
        if flyConnection then
            flyConnection:Disconnect()
        end
        
        flyConnection = RunService.Heartbeat:Connect(function()
            if humanoidRootPart and flyEnabled then
                local currentPosition = humanoidRootPart.Position
                
                -- –ü–ª–∞–≤–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –≤—ã—Å–æ—Ç—É –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                if math.abs(currentPosition.Y - targetYPosition) > 1 then
                    local smoothY = currentPosition.Y + (targetYPosition - currentPosition.Y) * 0.1
                    local newPosition = Vector3.new(
                        currentPosition.X,
                        smoothY,
                        currentPosition.Z
                    )
                    humanoidRootPart.CFrame = CFrame.new(newPosition)
                end
            end
        end)
        
        -- –ê–Ω–∏–º–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∏—è
        TweenService:Create(TpUpButton, TweenInfo.new(0.3), {
            BackgroundColor3 = Color3.fromRGB(60, 150, 200)
        }):Play()
        
    else
        -- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤—ã—Ö–æ–¥ –∏–∑ –ø–æ–ª—ë—Ç–∞
        safeExitFly()
        
        TpUpButton.Text = "‚¨ÜÔ∏è Fly Mode: OFF"
        
        -- –û—Ç–∫–ª—é—á–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
        if flyConnection then
            flyConnection:Disconnect()
            flyConnection = nil
        end
        
        -- –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—é
        workspace.Gravity = originalGravity
        
        -- –ê–Ω–∏–º–∞—Ü–∏—è –≤—ã–∫–ª—é—á–µ–Ω–∏—è
        TweenService:Create(TpUpButton, TweenInfo.new(0.3), {
            BackgroundColor3 = Color3.fromRGB(45, 45, 60)
        }):Play()
    end
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç—å—é
local function toggleSpeed()
    speedEnabled = not speedEnabled
    
    if speedEnabled then
        SpeedButton.Text = "üöÄ Speed: ON (" .. targetSpeed .. ")"
        
        -- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å
        if humanoid then
            humanoid.WalkSpeed = targetSpeed
        end
        
        -- –°–æ–∑–¥–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏
        if speedConnection then
            speedConnection:Disconnect()
        end
        
        speedConnection = RunService.Heartbeat:Connect(function()
            if humanoid and humanoid.WalkSpeed ~= targetSpeed then
                humanoid.WalkSpeed = targetSpeed
            end
        end)
        
        -- –ê–Ω–∏–º–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∏—è
        TweenService:Create(SpeedButton, TweenInfo.new(0.3), {
            BackgroundColor3 = Color3.fromRGB(60, 150, 60)
        }):Play()
        
    else
        SpeedButton.Text = "üöÄ Speed: OFF"
        
        -- –û—Ç–∫–ª—é—á–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
        if speedConnection then
            speedConnection:Disconnect()
            speedConnection = nil
        end
        
        -- –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å
        if humanoid then
            humanoid.WalkSpeed = 16
        end
        
        -- –ê–Ω–∏–º–∞—Ü–∏—è –≤—ã–∫–ª—é—á–µ–Ω–∏—è
        TweenService:Create(SpeedButton, TweenInfo.new(0.3), {
            BackgroundColor3 = Color3.fromRGB(45, 45, 60)
        }):Play()
    end
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–∞–∑—ã
local function setBasePosition()
    if humanoidRootPart then
        basePosition = humanoidRootPart.Position
        createBaseMarker(basePosition)
        SetBaseButton.Text = "üè† Base Set ‚úì"
        
        -- –ê–Ω–∏–º–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏
        TweenService:Create(SetBaseButton, TweenInfo.new(0.3), {
            BackgroundColor3 = Color3.fromRGB(60, 200, 60)
        }):Play()
        
        print("Base position set at: " .. tostring(basePosition))
    end
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª–µ—Ç–∞ –∫ –±–∞–∑–µ
local function flyToBase()
    if not basePosition then
        -- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –µ—Å–ª–∏ –±–∞–∑–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
        FlyToBaseButton.Text = "‚úàÔ∏è Set Base First!"
        
        -- –ê–Ω–∏–º–∞—Ü–∏—è –æ—à–∏–±–∫–∏
        TweenService:Create(FlyToBaseButton, TweenInfo.new(0.3), {
            BackgroundColor3 = Color3.fromRGB(200, 60, 60)
        }):Play()
        
        -- –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
        task.wait(2)
        FlyToBaseButton.Text = "‚úàÔ∏è Fly to Base"
        TweenService:Create(FlyToBaseButton, TweenInfo.new(0.3), {
            BackgroundColor3 = Color3.fromRGB(45, 45, 60)
        }):Play()
        
        return
    end
    
    -- –í–∫–ª—é—á–∞–µ–º –Ω–æ—É–∫–ª–∏–ø (–æ—Ç–∫–ª—é—á–∞–µ–º –∫–æ–ª–ª–∏–∑–∏–∏)
    humanoid:ChangeState(Enum.HumanoidStateType.Physics)
    
    -- –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—é
    local tempGravity = workspace.Gravity
    workspace.Gravity = 0
    
    -- –ü–æ–¥–Ω–∏–º–∞–µ–º –∏–≥—Ä–æ–∫–∞ –Ω–∞ 100 studs –≤–≤–µ—Ä—Ö
    local startPosition = humanoidRootPart.Position
    local ascentPosition = Vector3.new(startPosition.X, startPosition.Y + 100, startPosition.Z)
    
    -- –ü–ª–∞–≤–Ω—ã–π –ø–æ–¥—ä–µ–º –≤–≤–µ—Ä—Ö
    local ascentTime = 1.5
    local startTime = tick()
    
    local ascentConnection
    ascentConnection = RunService.Heartbeat:Connect(function()
        local progress = (tick() - startTime) / ascentTime
        if progress >= 1 then
            humanoidRootPart.CFrame = CFrame.new(ascentPosition)
            ascentConnection:Disconnect()
            
            -- –ü–æ—Å–ª–µ –ø–æ–¥—ä–µ–º–∞ –ª–µ—Ç–∏–º –∫ –±–∞–∑–µ
            local flightTime = 3.0
            local flightStartTime = tick()
            local flightStartPosition = ascentPosition
            
            local flightConnection
            flightConnection = RunService.Heartbeat:Connect(function()
                local flightProgress = (tick() - flightStartTime) / flightTime
                if flightProgress >= 1 then
                    -- –ó–∞–≤–µ—Ä—à–∞–µ–º –ø–æ–ª–µ—Ç
                    humanoidRootPart.CFrame = CFrame.new(basePosition)
                    flightConnection:Disconnect()
                    
                    -- –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—é –∏ –∫–æ–ª–ª–∏–∑–∏–∏
                    workspace.Gravity = tempGravity
                    humanoid:ChangeState(Enum.HumanoidStateType.GettingUp)
                    
                    -- –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –≤–∏–¥ –∫–Ω–æ–ø–∫–∏
                    FlyToBaseButton.Text = "‚úàÔ∏è Fly to Base"
                    TweenService:Create(FlyToBaseButton, TweenInfo.new(0.3), {
                        BackgroundColor3 = Color3.fromRGB(45, 45, 60)
                    }):Play()
                    
                else
                    -- –ü–ª–∞–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –∫ –±–∞–∑–µ
                    local smoothProgress = 1 - math.cos(flightProgress * math.pi / 2) -- Ease-out
                    local currentPosition = flightStartPosition + (basePosition - flightStartPosition) * smoothProgress
                    humanoidRootPart.CFrame = CFrame.new(currentPosition)
                end
            end)
            
        else
            -- –ü–ª–∞–≤–Ω—ã–π –ø–æ–¥—ä–µ–º
            local smoothProgress = 1 - math.cos(progress * math.pi / 2) -- Ease-out
            local currentY = startPosition.Y + (100 * smoothProgress)
            local currentPosition = Vector3.new(startPosition.X, currentY, startPosition.Z)
            humanoidRootPart.CFrame = CFrame.new(currentPosition)
        end
    end)
    
    -- –ú–µ–Ω—è–µ–º –≤–∏–¥ –∫–Ω–æ–ø–∫–∏ –≤–æ –≤—Ä–µ–º—è –ø–æ–ª–µ—Ç–∞
    FlyToBaseButton.Text = "‚úàÔ∏è Flying..."
    TweenService:Create(FlyToBaseButton, TweenInfo.new(0.3), {
        BackgroundColor3 = Color3.fromRGB(60, 150, 200)
    }):Play()
end

-- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ Fly Mode
TpUpButton.MouseButton1Click:Connect(function()
    toggleFly()
    
    -- –ê–Ω–∏–º–∞—Ü–∏—è –Ω–∞–∂–∞—Ç–∏—è
    TweenService:Create(TpUpButton, TweenInfo.new(0.1), {
        BackgroundColor3 = Color3.fromRGB(65, 65, 85)
    }):Play()
    task.wait(0.1)
    if flyEnabled then
        TweenService:Create(TpUpButton, TweenInfo.new(0.2), {
            BackgroundColor3 = Color3.fromRGB(60, 150, 200)
        }):Play()
    else
        TweenService:Create(TpUpButton, TweenInfo.new(0.2), {
            BackgroundColor3 = Color3.fromRGB(45, 45, 60)
        }):Play()
    end
end)

-- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ TP Forward
TpForwardButton.MouseButton1Click:Connect(function()
    if character and humanoidRootPart then
        local currentCFrame = humanoidRootPart.CFrame
        local newPosition = currentCFrame.Position + currentCFrame.LookVector * 5
        smoothTeleport(newPosition)
        
        -- –ê–Ω–∏–º–∞—Ü–∏—è –Ω–∞–∂–∞—Ç–∏—è
        TweenService:Create(TpForwardButton, TweenInfo.new(0.1), {
            BackgroundColor3 = Color3.fromRGB(65, 65, 85)
        }):Play()
        task.wait(0.1)
        TweenService:Create(TpForwardButton, TweenInfo.new(0.2), {
            BackgroundColor3 = Color3.fromRGB(45, 45, 60)
        }):Play()
    end
end)

-- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ Speed
SpeedButton.MouseButton1Click:Connect(function()
    toggleSpeed()
end)

-- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ Set Base
SetBaseButton.MouseButton1Click:Connect(function()
    setBasePosition()
    
    -- –ê–Ω–∏–º–∞—Ü–∏—è –Ω–∞–∂–∞—Ç–∏—è
    TweenService:Create(SetBaseButton, TweenInfo.new(0.1), {
        BackgroundColor3 = Color3.fromRGB(65, 65, 85)
    }):Play()
    task.wait(0.1)
    TweenService:Create(SetBaseButton, TweenInfo.new(0.2), {
        BackgroundColor3 = Color3.fromRGB(60, 200, 60)
    }):Play()
end)

-- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ Fly to Base
FlyToBaseButton.MouseButton1Click:Connect(function()
    flyToBase()
    
    -- –ê–Ω–∏–º–∞—Ü–∏—è –Ω–∞–∂–∞—Ç–∏—è
    TweenService:Create(FlyToBaseButton, TweenInfo.new(0.1), {
        BackgroundColor3 = Color3.fromRGB(65, 65, 85)
        }):Play()
    task.wait(0.1)
    TweenService:Create(FlyToBaseButton, TweenInfo.new(0.2), {
        BackgroundColor3 = Color3.fromRGB(60, 150, 200)
    }):Play()
end)

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ –∫–Ω–æ–ø–æ–∫ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
local function setupButtonHover(button)
    local originalColor = button.BackgroundColor3
    
    button.MouseEnter:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.2), {
            BackgroundColor3 = Color3.fromRGB(55, 55, 75)
        }):Play()
    end)
    
    button.MouseLeave:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.2), {
            BackgroundColor3 = originalColor
        }):Play()
    end)
end

-- –ü—Ä–∏–º–µ–Ω—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –∫–æ –≤—Å–µ–º –∫–Ω–æ–ø–∫–∞–º
setupButtonHover(TpUpButton)
setupButtonHover(TpForwardButton)
setupButtonHover(SpeedButton)
setupButtonHover(SetBaseButton)
setupButtonHover(FlyToBaseButton)

-- –û–±–Ω–æ–≤–ª—è–µ–º humanoidRootPart –∏ humanoid –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
player.CharacterAdded:Connect(function(newCharacter)
    character = newCharacter
    humanoidRootPart = newCharacter:WaitForChild("HumanoidRootPart")
    humanoid = newCharacter:WaitForChild("Humanoid")
    
    -- –ï—Å–ª–∏ —Å–∫–æ—Ä–æ—Å—Ç—å –±—ã–ª–∞ –≤–∫–ª—é—á–µ–Ω–∞, –ø—Ä–∏–º–µ–Ω—è–µ–º –µ—ë –∫ –Ω–æ–≤–æ–º—É –ø–µ—Ä—Å–æ–Ω–∞–∂—É
    if speedEnabled and speedConnection then
        speedConnection:Disconnect()
        speedConnection = RunService.Heartbeat:Connect(function()
            if humanoid and humanoid.WalkSpeed ~= targetSpeed then
                humanoid.WalkSpeed = targetSpeed
            end
        end)
    end
    
    -- –ï—Å–ª–∏ –ø–æ–ª—ë—Ç –±—ã–ª –≤–∫–ª—é—á–µ–Ω, –±–µ–∑–æ–ø–∞—Å–Ω–æ –≤—ã–∫–ª—é—á–∞–µ–º –µ–≥–æ
    if flyEnabled and flyConnection then
        safeExitFly()
        flyConnection:Disconnect()
        flyEnabled = false
        TpUpButton.Text = "‚¨ÜÔ∏è Fly Mode: OFF"
        TweenService:Create(TpUpButton, TweenInfo.new(0.3), {
            BackgroundColor3 = Color3.fromRGB(45, 45, 60)
        }):Play()
        workspace.Gravity = originalGravity
    end
    
    -- –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ Set Base
    SetBaseButton.Text = "üè† Set Base"
    TweenService:Create(SetBaseButton, TweenInfo.new(0.3), {
        BackgroundColor3 = Color3.fromRGB(45, 45, 60)
    }):Play()
end)

-- –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ GUI
ScreenGui.Destroying:Connect(function()
    if speedConnection then
        speedConnection:Disconnect()
    end
    if flyConnection then
        flyConnection:Disconnect()
    end
    -- –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—é
    workspace.Gravity = originalGravity
    
    -- –£–¥–∞–ª—è–µ–º –º–∞—Ä–∫–µ—Ä –±–∞–∑—ã
    if baseMarker then
        baseMarker:Destroy()
    end
end)

-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ –∫–æ–Ω—Å–æ–ª—å
print("Menu loaded! Made by xabib")
print("Fly Mode: Flies at 100 studs height with anti-fall protection")
print("TP Forward: Instant forward teleport")
print("Speed: Constant 100 studs speed")
print("Set Base: Sets your current position as base with marker")
print("Fly to Base: Flies to set base position with smooth animation")
